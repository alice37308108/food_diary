{% extends "base.html" %}
{% load static %}
{% load vitamin_filters %}
{% block content %}
    {% load static %}
    <div style="text-align: center;">
        ğŸŒ¸ãƒ“ã‚¿ãƒŸãƒ³Cç®¡ç†ğŸŒ¸

        <div class="card shadow-sm mx-auto" style="max-width: 600px; margin-bottom: 20px;">
            <div class="card-header bg-white">
                <h4 class="mb-0">{{ today|date:"Yå¹´mæœˆdæ—¥" }}</h4>
            </div>
            <div class="card-body">
                <div class="mb-4">
                    <h5>é€²æ—çŠ¶æ³</h5>
                    <h4>{{ intake.intake_count }} / {{ intake.daily_goal }} æ¯</h4>

                    <div class="progress" style="height: 25px; margin-bottom: 10px;">
                        <div class="progress-bar bg-warning" role="progressbar"
                             style="width: {{ progress }}%;"
                             aria-valuenow="{{ intake.intake_count }}"
                             aria-valuemin="0"
                             aria-valuemax="{{ intake.daily_goal }}">
                            {{ progress|floatformat:0 }}%
                        </div>
                    </div>

                    <div class="mt-2">
                        {% if is_on_track %}
                            <p class="text-success">ç¾åœ¨ã®æ™‚é–“å¸¯ã®ç›®æ¨™ï¼ˆ{{ time_goal }}æ¯ï¼‰ã‚’é”æˆã—ã¦ã„ã¾ã™ï¼</p>
                        {% else %}
                            {% with remaining=time_goal|subtract:intake.intake_count %}
                                <p class="text-danger">ç¾åœ¨ã®æ™‚é–“å¸¯ã§ã¯ {{ time_goal }}æ¯ãŒç›®æ¨™ã§ã™ã€‚ã‚ã¨{{ remaining }}æ¯é ‘å¼µã‚Šã¾ã—ã‚‡ã†ï¼</p>
                            {% endwith %}
                        {% endif %}
                    </div>
                </div>

                <div class="mb-4">
                    <form method="post" class="d-flex justify-content-center gap-2">
                        {% csrf_token %}
                        <button type="submit" name="action" value="decrement" class="btn btn-outline-danger">
                            -1
                        </button>
                        <button type="submit" name="action" value="increment" class="btn btn-outline-success">
                            +1
                        </button>
                        <button type="submit" name="action" value="reset" class="btn btn-outline-secondary">
                            ãƒªã‚»ãƒƒãƒˆ
                        </button>
                    </form>
                </div>

                <div class="mb-4">
                    <h5>ç›®æ¨™è¨­å®š</h5>
                    <form method="post" class="d-flex justify-content-center gap-2">
                        {% csrf_token %}
                        <input type="number" name="daily_goal" class="form-control" value="{{ intake.daily_goal }}"
                               min="1" max="50" style="max-width: 80px;">
                        <button type="submit" name="action" value="update_goal" class="btn btn-outline-warning">
                            æ›´æ–°
                        </button>
                    </form>
                </div>
            </div>
        </div>

        <div class="card shadow-sm mx-auto" style="max-width: 600px; margin-bottom: 20px;">
            <div class="card-header bg-white">
                <h5 class="mb-0">ä»Šæ—¥ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ææ¡ˆ</h5>
            </div>
            <div class="card-body">
                <ul class="list-group list-group-flush">
                    {% for item in schedule %}
                        <li class="list-group-item">
                            {{ item.æ™‚é–“å¸¯ }}: {{ item.ç›®æ¨™ }}æ¯
                        </li>
                    {% endfor %}
                </ul>
            </div>
        </div>

        <img src="{% static 'gratitude/images/obu_bouquet.png' %}" alt="vitamin" class="img-fluid"
             style="padding: 20px; max-width: 40%; height: auto;">
        <br>

        <button type="button" class="btn btn-outline-warning"
                onclick="location.href='{% url 'vitamin:history' %}'">
            å±¥æ­´ã‚’è¦‹ã‚‹
        </button>

    </div>
{% endblock %}